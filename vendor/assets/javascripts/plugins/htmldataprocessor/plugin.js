(function(){var E=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/;var F="{cke_protected}";function h(I){var J=I.children.length,i=I.children[J-1];while(i&&i.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(i.value)){i=I.children[--J]}return i}function q(K,i){var I=K.children,J=h(K);if(J){if((i||!CKEDITOR.env.ie)&&J.type==CKEDITOR.NODE_ELEMENT&&J.name=="br"){I.pop()}if(J.type==CKEDITOR.NODE_TEXT&&E.test(J.value)){I.pop()}}}function D(K,i,I){if(!i&&(!I||typeof I=="function"&&(I(K)===false))){return false}if(i&&CKEDITOR.env.ie&&(document.documentMode>7||K.name in CKEDITOR.dtd.tr||K.name in CKEDITOR.dtd.$listItem)){return false}var J=h(K);return !J||J&&(J.type==CKEDITOR.NODE_ELEMENT&&J.name=="br"||K.name=="form"&&J.name=="input")}function m(I,i){return function(J){q(J,!I);if(D(J,!I,i)){if(I||CKEDITOR.env.ie){J.add(new CKEDITOR.htmlParser.text("\xa0"))}else{J.add(new CKEDITOR.htmlParser.element("br",{}))}}}}var u=CKEDITOR.dtd;var G=["caption","colgroup","col","thead","tfoot","tbody"];var d=CKEDITOR.tools.extend({},u.$block,u.$listItem,u.$tableContent);for(var A in d){if(!("br" in u[A])){delete d[A]}}delete d.pre;var w={elements:{},attributeNames:[[(/^on/),"data-cke-pa-on"]]};var f={elements:{}};for(A in d){f.elements[A]=m()}var c={elementNames:[[(/^cke:/),""],[(/^\?xml:namespace$/),""]],attributeNames:[[(/^data-cke-(saved|pa)-/),""],[(/^data-cke-.*/),""],["hidefocus",""]],elements:{$:function(K){var M=K.attributes;if(M){if(M["data-cke-temp"]){return false}var L=["name","href","src"],J;for(var I=0;I<L.length;I++){J="data-cke-saved-"+L[I];J in M&&(delete M[L[I]])}}return K},table:function(I){var i=I.children;i.sort(function(K,J){return K.type==CKEDITOR.NODE_ELEMENT&&J.type==K.type?CKEDITOR.tools.indexOf(G,K.name)>CKEDITOR.tools.indexOf(G,J.name)?1:-1:0})},embed:function(I){var K=I.parent;if(K&&K.name=="object"){var J=K.attributes.width,i=K.attributes.height;J&&(I.attributes.width=J);i&&(I.attributes.height=i)}},param:function(i){i.children=[];i.isEmpty=true;return i},a:function(i){if(!(i.children.length||i.attributes.name||i.attributes["data-cke-saved-name"])){return false}},span:function(i){if(i.attributes["class"]=="Apple-style-span"){delete i.name}},pre:function(i){CKEDITOR.env.ie&&q(i)},html:function(i){delete i.attributes.contenteditable;delete i.attributes["class"]},body:function(i){delete i.attributes.spellcheck;delete i.attributes.contenteditable},style:function(i){var I=i.children[0];I&&I.value&&(I.value=CKEDITOR.tools.trim(I.value));if(!i.attributes.type){i.attributes.type="text/css"}},title:function(I){var i=I.children[0];i&&(i.value=I.attributes["data-cke-title"]||"")}},attributes:{"class":function(I,i){return CKEDITOR.tools.ltrim(I.replace(/(?:^|\s+)cke_[^\s]*/g,""))||false}}};if(CKEDITOR.env.ie){c.attributes.style=function(I,i){return I.replace(/(^|;)([^\:]+)/g,function(J){return J.toLowerCase()})}}function n(I){var i=I.attributes;if(i.contenteditable!="false"){i["data-cke-editable"]=i.contenteditable?"true":1}i.contenteditable="false"}function a(I){var i=I.attributes;switch(i["data-cke-editable"]){case"true":i.contenteditable="true";break;case"1":delete i.contenteditable;break}}for(A in {input:1,textarea:1}){w.elements[A]=n;c.elements[A]=a}var t=/<(a|area|img|input)\b([^>]*)>/gi,r=/\b(on\w+|href|src|name)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi;var l=/(?:<style(?=[ >])[^>]*>[\s\S]*<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,H=/<cke:encoded>([^<]*)<\/cke:encoded>/gi;var k=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,o=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi;var g=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi;function s(i){return i.replace(t,function(K,I,J){return"<"+I+J.replace(r,function(M,L){if(!(/^on/).test(L)&&J.indexOf("data-cke-saved-"+L)==-1){return" data-cke-saved-"+M+" "+M}return M})+">"})}function e(i){return i.replace(l,function(I){return"<cke:encoded>"+encodeURIComponent(I)+"</cke:encoded>"})}function b(i){return i.replace(H,function(I,J){return decodeURIComponent(J)})}function v(i){return i.replace(k,"$1cke:$2")}function y(i){return i.replace(o,"$1$2")}function C(i){return i.replace(g,"<cke:$1$2></cke:$1>")}function z(i){return i.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2")}function x(i){return i.replace(/<!--(?!{cke_protected})[\s\S]+?-->/g,function(I){return"<!--"+F+"{C}"+encodeURIComponent(I).replace(/--/g,"%2D%2D")+"-->"})}function p(i){return i.replace(/<!--\{cke_protected\}\{C\}([\s\S]+?)-->/g,function(I,J){return decodeURIComponent(J)})}function j(I,J){var i=J._.dataStore;return I.replace(/<!--\{cke_protected\}([\s\S]+?)-->/g,function(K,L){return decodeURIComponent(L)}).replace(/\{cke_protected_(\d+)\}/g,function(K,L){return i&&i[L]||""})}function B(O,N){var J=[],P=N.config.protectedSource,K=N._.dataStore||(N._.dataStore={id:1}),M=/<\!--\{cke_temp(comment)?\}(\d*?)-->/g;var I=[(/<script[\s\S]*?<\/script>/gi),/<noscript[\s\S]*?<\/noscript>/gi].concat(P);O=O.replace((/<!--[\s\S]*?-->/g),function(i){return"<!--{cke_tempcomment}"+(J.push(i)-1)+"-->"});for(var L=0;L<I.length;L++){O=O.replace(I[L],function(i){i=i.replace(M,function(R,Q,S){return J[S]});return(/cke_temp(comment)?/).test(i)?i:"<!--{cke_temp}"+(J.push(i)-1)+"-->"})}O=O.replace(M,function(Q,i,R){return"<!--"+F+(i?"{C}":"")+encodeURIComponent(J[R]).replace(/--/g,"%2D%2D")+"-->"});return O.replace(/(['"]).*?\1/g,function(i){return i.replace(/<!--\{cke_protected\}([\s\S]+?)-->/g,function(Q,R){K[K.id]=decodeURIComponent(R);return"{cke_protected_"+(K.id++)+"}"})})}CKEDITOR.plugins.add("htmldataprocessor",{requires:["htmlwriter"],init:function(J){var i=J.dataProcessor=new CKEDITOR.htmlDataProcessor(J);i.writer.forceSimpleAmpersand=J.config.forceSimpleAmpersand;i.dataFilter.addRules(w);i.dataFilter.addRules(f);i.htmlFilter.addRules(c);var I={elements:{}};for(A in d){I.elements[A]=m(true,J.config.fillEmptyBlocks)}i.htmlFilter.addRules(I)},onLoad:function(){!("fillEmptyBlocks" in CKEDITOR.config)&&(CKEDITOR.config.fillEmptyBlocks=1)}});CKEDITOR.htmlDataProcessor=function(i){this.editor=i;this.writer=new CKEDITOR.htmlWriter();this.dataFilter=new CKEDITOR.htmlParser.filter();this.htmlFilter=new CKEDITOR.htmlParser.filter()};CKEDITOR.htmlDataProcessor.prototype={toHtml:function(K,i){K=B(K,this.editor);K=s(K);K=e(K);K=v(K);K=C(K);K=z(K);var L=new CKEDITOR.dom.element("div");L.setHtml("a"+K);K=L.getHtml().substr(1);K=y(K);K=b(K);K=p(K);var I=CKEDITOR.htmlParser.fragment.fromHtml(K,i),J=new CKEDITOR.htmlParser.basicWriter();I.writeHtml(J,this.dataFilter);K=J.getHtml(true);K=x(K);return K},toDataFormat:function(J,i){var L=this.writer,I=CKEDITOR.htmlParser.fragment.fromHtml(J,i);L.reset();I.writeHtml(L,this.htmlFilter);var K=L.getHtml(true);K=p(K);K=j(K,this.editor);return K}}})();