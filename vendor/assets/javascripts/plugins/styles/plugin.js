CKEDITOR.plugins.add("styles",{requires:["selection"],init:function(a){a.on("contentDom",function(){a.document.setCustomData("cke_includeReadonly",!a.config.disableReadonlyStyling)})}});CKEDITOR.editor.prototype.attachStyleStateChange=function(a,c){var b=this._.styleStateChangeCallbacks;if(!b){b=this._.styleStateChangeCallbacks=[];this.on("selectionChange",function(f){for(var d=0;d<b.length;d++){var g=b[d];var e=g.style.checkActive(f.data.path)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;g.fn.call(this,e)}})}b.push({style:a,fn:c})};CKEDITOR.STYLE_BLOCK=1;CKEDITOR.STYLE_INLINE=2;CKEDITOR.STYLE_OBJECT=3;(function(){var i={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},x={a:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1};var F=/\s*(?:;\s*|$)/,c=/#\((.+?)\)/g;var f=CKEDITOR.dom.walker.bookmark(0,1),t=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(J,I){if(I){J=CKEDITOR.tools.clone(J);k(J.attributes,I);k(J.styles,I)}var H=this.element=J.element?(typeof J.element=="string"?J.element.toLowerCase():J.element):"*";this.type=i[H]?CKEDITOR.STYLE_BLOCK:x[H]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE;if(typeof this.element=="object"){this.type=CKEDITOR.STYLE_OBJECT}this._={definition:J}};CKEDITOR.style.prototype={apply:function(H){D.call(this,H,false)},remove:function(H){D.call(this,H,true)},applyToRange:function(H){return(this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?u:this.type==CKEDITOR.STYLE_OBJECT?d:null).call(this,H)},removeFromRange:function(H){return(this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?y:this.type==CKEDITOR.STYLE_BLOCK?s:this.type==CKEDITOR.STYLE_OBJECT?r:null).call(this,H)},applyToObject:function(H){G(H,this)},checkActive:function(K){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(K.block||K.blockLimit,true);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:var L=K.elements;for(var J=0,I;J<L.length;J++){I=L[J];if(this.type==CKEDITOR.STYLE_INLINE&&(I==K.block||I==K.blockLimit)){continue}if(this.type==CKEDITOR.STYLE_OBJECT){var H=I.getName();if(!(typeof this.element=="string"?H==this.element:H in this.element)){continue}}if(this.checkElementRemovable(I,true)){return true}}}return false},checkApplicable:function(H){switch(this.type){case CKEDITOR.STYLE_INLINE:case CKEDITOR.STYLE_BLOCK:break;case CKEDITOR.STYLE_OBJECT:return H.lastElement.getAscendant(this.element,true)}return true},checkElementRemovable:function(N,K){var L=this._.definition;if(!N||!L.ignoreReadonly&&N.isReadOnly()){return false}var H,I=N.getName();if(typeof this.element=="string"?I==this.element:I in this.element){if(!K&&!N.hasAttributes()){return true}H=m(L);if(H._length){for(var O in H){if(O=="_length"){continue}var P=N.getAttribute(O)||"";if(O=="style"?v(H[O],l(P,false)):H[O]==P){if(!K){return true}}else{if(K){return false}}}if(K){return true}}else{return true}}var J=z(this)[N.getName()];if(J){if(!(H=J.attributes)){return true}for(var M=0;M<H.length;M++){O=H[M][0];var Q=N.getAttribute(O);if(Q){var R=H[M][1];if(R===null||(typeof R=="string"&&Q==R)||R.test(Q)){return true}}}}return false},buildPreview:function(J){var L=this._.definition,K=[],H=L.element;if(H=="bdo"){H="span"}K=["<",H];var M=L.attributes;if(M){for(var I in M){K.push(" ",I,'="',M[I],'"')}}var N=CKEDITOR.style.getStyleText(L);if(N){K.push(' style="',N,'"')}K.push(">",(J||L.name),"</",H,">");return K.join("")}};CKEDITOR.style.getStyleText=function(K){var I=K._ST;if(I){return I}I=K.styles;var H=(K.attributes&&K.attributes.style)||"",L="";if(H.length){H=H.replace(F,";")}for(var J in I){var N=I[J],M=(J+":"+N).replace(F,";");if(N=="inherit"){L+=M}else{H+=M}}if(H.length){H=l(H)}H+=L;return(K._ST=H)};function j(J){var H,I;while((J=J.getParent())){if(J.getName()=="body"){break}if(J.getAttribute("data-nostyle")){H=J}else{if(!I){var K=J.getAttribute("contentEditable");if(K=="false"){H=J}else{if(K=="true"){I=1}}}}}return H}function n(Z){var aa=Z.document;if(Z.collapsed){var I=o(this,aa);Z.insertNode(I);Z.moveToPosition(I,CKEDITOR.POSITION_BEFORE_END);return}var V=this.element;var X=this._.definition;var ad;var T=X.ignoreReadonly,Q=T||X.includeReadonly;if(Q==undefined){Q=aa.getCustomData("cke_includeReadonly")}var ac=CKEDITOR.dtd[V]||(ad=true,CKEDITOR.dtd.span);Z.enlarge(CKEDITOR.ENLARGE_ELEMENT,1);Z.trim();var ah=Z.createBookmark(),ae=ah.startNode,N=ah.endNode;var J=ae;var W;if(!T){var M=j(ae),af=j(N);if(M){J=M.getNextSourceNode(true)}if(af){N=af}}if(J.getPosition(N)==CKEDITOR.POSITION_FOLLOWING){J=0}while(J){var ak=false;if(J.equals(N)){J=null;ak=true}else{var L=J.type;var H=L==CKEDITOR.NODE_ELEMENT?J.getName():null;var O=H&&(J.getAttribute("contentEditable")=="false");var P=H&&J.getAttribute("data-nostyle");if(H&&J.data("cke-bookmark")){J=J.getNextSourceNode(true);continue}if(!H||(ac[H]&&!P&&(!O||Q)&&(J.getPosition(N)|CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED)==(CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IDENTICAL+CKEDITOR.POSITION_IS_CONTAINED)&&(!X.childRule||X.childRule(J)))){var al=J.getParent();if(al&&((al.getDtd()||CKEDITOR.dtd.span)[V]||ad)&&(!X.parentRule||X.parentRule(al))){if(!W&&(!H||!CKEDITOR.dtd.$removeEmpty[H]||(J.getPosition(N)|CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED)==(CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IDENTICAL+CKEDITOR.POSITION_IS_CONTAINED))){W=new CKEDITOR.dom.range(aa);W.setStartBefore(J)}if(L==CKEDITOR.NODE_TEXT||O||(L==CKEDITOR.NODE_ELEMENT&&!J.getChildCount())){var Y=J;var S;while((ak=!Y.getNext(f))&&(S=Y.getParent(),ac[S.getName()])&&(S.getPosition(ae)|CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED)==(CKEDITOR.POSITION_FOLLOWING+CKEDITOR.POSITION_IDENTICAL+CKEDITOR.POSITION_IS_CONTAINED)&&(!X.childRule||X.childRule(S))){Y=S}W.setEndAfter(Y)}}else{ak=true}}else{ak=true}J=J.getNextSourceNode(P||O)}if(ak&&W&&!W.collapsed){var aj=o(this,aa),R=aj.hasAttributes();var U=W.getCommonAncestor();var ai={styles:{},attrs:{},blockedStyles:{},blockedAttrs:{}};var ag,K,ab;while(aj&&U){if(U.getName()==V){for(ag in X.attributes){if(ai.blockedAttrs[ag]||!(ab=U.getAttribute(K))){continue}if(aj.getAttribute(ag)==ab){ai.attrs[ag]=1}else{ai.blockedAttrs[ag]=1}}for(K in X.styles){if(ai.blockedStyles[K]||!(ab=U.getStyle(K))){continue}if(aj.getStyle(K)==ab){ai.styles[K]=1}else{ai.blockedStyles[K]=1}}}U=U.getParent()}for(ag in ai.attrs){aj.removeAttribute(ag)}for(K in ai.styles){aj.removeStyle(K)}if(R&&!aj.hasAttributes()){aj=null}if(aj){W.extractContents().appendTo(aj);h(this,aj);W.insertNode(aj);aj.mergeSiblings();if(!CKEDITOR.env.ie){aj.$.normalize()}}else{aj=new CKEDITOR.dom.element("span");W.extractContents().appendTo(aj);W.insertNode(aj);h(this,aj);aj.remove(true)}W=null}}Z.moveToBookmark(ah);Z.shrink(CKEDITOR.SHRINK_TEXT)}function y(P){P.enlarge(CKEDITOR.ENLARGE_ELEMENT,1);var S=P.createBookmark(),J=S.startNode;if(P.collapsed){var V=new CKEDITOR.dom.elementPath(J.getParent()),L;for(var N=0,O;N<V.elements.length&&(O=V.elements[N]);N++){if(O==V.block||O==V.blockLimit){break}if(this.checkElementRemovable(O)){var H;if(P.collapsed&&(P.checkBoundaryOfElement(O,CKEDITOR.END)||(H=P.checkBoundaryOfElement(O,CKEDITOR.START)))){L=O;L.match=H?"start":"end"}else{O.mergeSiblings();if(O.getName()==this.element){b(this,O)}else{A(O,z(this)[O.getName()])}}}}if(L){var M=J;for(N=0;;N++){var R=V.elements[N];if(R.equals(L)){break}else{if(R.match){continue}else{R=R.clone()}}R.append(M);M=R}M[L.match=="start"?"insertBefore":"insertAfter"](L)}}else{var Q=S.endNode,T=this;function U(){var aa=new CKEDITOR.dom.elementPath(J.getParent()),W=new CKEDITOR.dom.elementPath(Q.getParent()),ab=null,Z=null;for(var Y=0;Y<aa.elements.length;Y++){var X=aa.elements[Y];if(X==aa.block||X==aa.blockLimit){break}if(T.checkElementRemovable(X)){ab=X}}for(Y=0;Y<W.elements.length;Y++){X=W.elements[Y];if(X==W.block||X==W.blockLimit){break}if(T.checkElementRemovable(X)){Z=X}}if(Z){Q.breakParent(Z)}if(ab){J.breakParent(ab)}}U();var I=J;while(!I.equals(Q)){var K=I.getNextSourceNode();if(I.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(I)){if(I.getName()==this.element){b(this,I)}else{A(I,z(this)[I.getName()])}if(K.type==CKEDITOR.NODE_ELEMENT&&K.contains(J)){U();K=J.getNext()}}I=K}}P.moveToBookmark(S)}function d(I){var H=I.getCommonAncestor(true,true),J=H.getAscendant(this.element,true);J&&!J.isReadOnly()&&G(J,this)}function r(K){var H=K.getCommonAncestor(true,true),M=H.getAscendant(this.element,true);if(!M){return}var N=this,O=N._.definition,J=O.attributes;if(J){for(var I in J){M.removeAttribute(I,J[I])}}if(O.styles){for(var L in O.styles){if(!O.styles.hasOwnProperty(L)){continue}M.removeStyle(L)}}}function u(H){var J=H.createBookmark(true);var I=H.createIterator();I.enforceRealBlocks=true;if(this._.enterMode){I.enlargeBr=(this._.enterMode!=CKEDITOR.ENTER_BR)}var M;var K=H.document;var L;while((M=I.getNextParagraph())){if(!M.isReadOnly()){var N=o(this,K,M);B(M,N)}}H.moveToBookmark(J)}function s(H){var J=H.createBookmark(1);var I=H.createIterator();I.enforceRealBlocks=true;I.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;var K;while((K=I.getNextParagraph())){if(this.checkElementRemovable(K)){if(K.is("pre")){var L=this._.enterMode==CKEDITOR.ENTER_BR?null:H.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div");L&&K.copyAttributes(L);B(K,L)}else{b(this,K,1)}}}H.moveToBookmark(J)}function B(M,N){var H=!N;if(H){N=M.getDocument().createElement("div");M.copyAttributes(N)}var I=N&&N.is("pre");var J=M.is("pre");var L=I&&!J;var K=!I&&J;if(L){N=a(M,N)}else{if(K){N=p(H?[M.getHtml()]:e(M),N)}else{M.moveChildren(N)}}N.replace(M);if(I){E(N)}else{if(H){w(N)}}}function E(J){var I;if(!((I=J.getPrevious(t))&&I.is&&I.is("pre"))){return}var H=C(I.getHtml(),/\n$/,"")+"\n\n"+C(J.getHtml(),/^\n/,"");if(CKEDITOR.env.ie){J.$.outerHTML="<pre>"+H+"</pre>"}else{J.setHtml(H)}I.remove()}function e(L){var J=/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,I=L.getName(),H=C(L.getOuterHtml(),J,function(M,N,O){return N+"</pre>"+O+"<pre>"});var K=[];H.replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(N,M){K.push(M)});return K}function C(L,K,I){var H="",J="";L=L.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,function(O,N,M){N&&(H=N);M&&(J=M);return""});return H+L.replace(K,I)+J}function p(K,M){var J;if(K.length>1){J=new CKEDITOR.dom.documentFragment(M.getDocument())}for(var I=0;I<K.length;I++){var H=K[I];H=H.replace(/(\r\n|\r)/g,"\n");H=C(H,/^[ \t]*\n/,"");H=C(H,/\n$/,"");H=C(H,/^[ \t]+|[ \t]+$/g,function(N,P,O){if(N.length==1){return"&nbsp;"}else{if(!P){return CKEDITOR.tools.repeat("&nbsp;",N.length-1)+" "}else{return" "+CKEDITOR.tools.repeat("&nbsp;",N.length-1)}}});H=H.replace(/\n/g,"<br>");H=H.replace(/[ \t]{2,}/g,function(N){return CKEDITOR.tools.repeat("&nbsp;",N.length-1)+" "});if(J){var L=M.clone();L.setHtml(H);J.append(L)}else{M.setHtml(H)}}return J||M}function a(K,L){var I=K.getBogus();I&&I.remove();var J=K.getHtml();J=C(J,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");J=J.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1");J=J.replace(/([ \t\n\r]+|&nbsp;)/g," ");J=J.replace(/<br\b[^>]*>/gi,"\n");if(CKEDITOR.env.ie){var H=K.getDocument().createElement("div");H.append(L);L.$.outerHTML="<pre>"+J+"</pre>";L.copyAttributes(H.getFirst());L=H.getFirst().remove()}else{L.setHtml(J)}return L}function b(K,J){var M=K._.definition,H=CKEDITOR.tools.extend({},M.attributes,z(K)[J.getName()]),L=M.styles,O=CKEDITOR.tools.isEmpty(H)&&CKEDITOR.tools.isEmpty(L);for(var N in H){if((N=="class"||K._.definition.fullMatch)&&J.getAttribute(N)!=q(N,H[N])){continue}O=J.hasAttribute(N);J.removeAttribute(N)}for(var I in L){if(K._.definition.fullMatch&&J.getStyle(I)!=q(I,L[I],true)){continue}O=O||!!J.getStyle(I);J.removeStyle(I)}if(O){!CKEDITOR.dtd.$block[J.getName()]||K._.enterMode==CKEDITOR.ENTER_BR&&!J.hasAttributes()?w(J):J.renameNode(K._.enterMode==CKEDITOR.ENTER_P?"p":"div")}}function h(I,K){var J=I._.definition,H=J.attributes,Q=J.styles,O=z(I),P=K.getElementsByTag(I.element);for(var L=P.count();--L>=0;){b(I,P.getItem(L))}for(var N in O){if(N!=I.element){P=K.getElementsByTag(N);for(L=P.count()-1;L>=0;L--){var M=P.getItem(L);A(M,O[N])}}}}function A(K,M){var H=M&&M.attributes;if(H){for(var J=0;J<H.length;J++){var L=H[J][0],N;if((N=K.getAttribute(L))){var I=H[J][1];if(I===null||(I.test&&I.test(N))||(typeof I=="string"&&N==I)){K.removeAttribute(L)}}}}w(K)}function w(H){if(!H.hasAttributes()){if(CKEDITOR.dtd.$block[H.getName()]){var K=H.getPrevious(t),I=H.getNext(t);if(K&&(K.type==CKEDITOR.NODE_TEXT||!K.isBlockBoundary({br:1}))){H.append("br",1)}if(I&&(I.type==CKEDITOR.NODE_TEXT||!I.isBlockBoundary({br:1}))){H.append("br")}H.remove(true)}else{var L=H.getFirst();var J=H.getLast();H.remove(true);if(L){L.type==CKEDITOR.NODE_ELEMENT&&L.mergeSiblings();if(J&&!L.equals(J)&&J.type==CKEDITOR.NODE_ELEMENT){J.mergeSiblings()}}}}}function o(K,L,I){var J,M=K._.definition,H=K.element;if(H=="*"){H="span"}J=new CKEDITOR.dom.element(H,L);if(I){I.copyAttributes(J)}J=G(J,K);if(L.getCustomData("doc_processing_style")&&J.hasAttribute("id")){J.removeAttribute("id")}else{L.setCustomData("doc_processing_style",1)}return J}function G(K,J){var M=J._.definition,I=M.attributes,L=CKEDITOR.style.getStyleText(M);if(I){for(var H in I){K.setAttribute(H,I[H])}}if(L){K.setAttribute("style",L)}return K}function k(J,H){for(var I in J){J[I]=J[I].replace(c,function(K,L){return H[L]})}}function m(I){var L=I._AC;if(L){return L}L={};var J=0;var K=I.attributes;if(K){for(var H in K){J++;L[H]=K[H]}}var M=CKEDITOR.style.getStyleText(I);if(M){if(!L.style){J++}L.style=M}L._length=J;return(I._AC=L)}function z(H){if(H._.overrides){return H._.overrides}var O=(H._.overrides={}),K=H._.definition.overrides;if(K){if(!CKEDITOR.tools.isArray(K)){K=[K]}for(var L=0;L<K.length;L++){var I=K[L];var Q;var M;var P;if(typeof I=="string"){Q=I.toLowerCase()}else{Q=I.element?I.element.toLowerCase():H.element;P=I.attributes}M=O[Q]||(O[Q]={});if(P){var J=(M.attributes=M.attributes||new Array());for(var N in P){J.push([N.toLowerCase(),P[N]])}}}}return O}function q(I,K,J){var H=new CKEDITOR.dom.element("span");H[J?"setStyle":"setAttribute"](I,K);return H[J?"getStyle":"getAttribute"](I)}function l(J,I){var K;if(I!==false){var H=new CKEDITOR.dom.element("span");H.setAttribute("style",J);K=H.getAttribute("style")||""}else{K=J}K=K.replace(/(font-family:)(.*?)(?=;|$)/,function(L,P,O){var N=O.split(",");for(var M=0;M<N.length;M++){N[M]=CKEDITOR.tools.trim(N[M].replace(/["']/g,""))}return P+N.join(",")});return K.replace(/\s*([;:])\s*/,"$1").replace(/([^\s;])$/,"$1;").replace(/,\s+/g,",").replace(/\"/g,"").toLowerCase()}function g(I){var H={};I.replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(K,J,L){H[J]=L});return H}function v(I,J){typeof I=="string"&&(I=g(I));typeof J=="string"&&(J=g(J));for(var H in I){if(!(H in J&&(J[H]==I[H]||I[H]=="inherit"||J[H]=="inherit"))){return false}}return true}function D(I,H){var N=I.getSelection(),M=N.createBookmarks(1),J=N.getRanges(),O=H?this.removeFromRange:this.applyToRange,K;var L=J.createIterator();while((K=L.getNextRange())){O.call(this,K)}if(M.length==1&&M[0].collapsed){N.selectRanges(J);I.getById(M[0].startNode).remove()}else{N.selectBookmarks(M)}I.removeCustomData("doc_processing_style")}})();CKEDITOR.styleCommand=function(a){this.style=a};CKEDITOR.styleCommand.prototype.exec=function(a){a.focus();var b=a.document;if(b){if(this.state==CKEDITOR.TRISTATE_OFF){this.style.apply(b)}else{if(this.state==CKEDITOR.TRISTATE_ON){this.style.remove(b)}}}return !!b};CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet");CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet);CKEDITOR.loadStylesSet=function(b,a,c){CKEDITOR.stylesSet.addExternal(b,a,"");CKEDITOR.stylesSet.load(b,c)};CKEDITOR.editor.prototype.getStylesSet=function(g){if(!this._.stylesDefinitions){var d=this,b=d.config.stylesCombo_stylesSet||d.config.stylesSet||"default";if(b instanceof Array){d._.stylesDefinitions=b;g(b);return}var c=b.split(":"),f=c[0],e=c[1],a=CKEDITOR.plugins.registered.styles.path;CKEDITOR.stylesSet.addExternal(f,e?c.slice(1).join(":"):a+"styles/"+f+".js","");CKEDITOR.stylesSet.load(f,function(h){d._.stylesDefinitions=h[f];g(d._.stylesDefinitions)})}else{g(this._.stylesDefinitions)}};