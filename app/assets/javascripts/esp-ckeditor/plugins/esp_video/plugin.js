CKEDITOR.plugins.add("esp_video",{lang:["en","ru","uk"],init:function(a){var b=a.lang.esp_video;if(typeof a.element.data=="undefined"){alert('The "video" plugin requires CKEditor 3.5 or newer');return}CKEDITOR.dialog.add("esp_video",this.path+"dialogs/esp_video.js");a.addCommand("esp_video",new CKEDITOR.dialogCommand("esp_video"));a.ui.addButton("Esp_video",{label:b.toolbar,command:"esp_video",icon:this.path+"images/esp_video.png"});a.addCss("img.cke_video{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;background-color:gray;border: 1px solid #a9a9a9;width: 80px;height: 80px;}");if(a.addMenuItems){a.addMenuItems({video:{label:b.properties,command:"video",group:"flash"}})}a.on("doubleclick",function(c){var d=c.data.element;if(d.is("img")&&d.data("cke-real-element-type")=="video"){c.data.dialog="video"}});if(a.contextMenu){a.contextMenu.addListener(function(c,d){if(c&&c.is("img")&&!c.isReadOnly()&&c.data("cke-real-element-type")=="video"){return{video:CKEDITOR.TRISTATE_OFF}}})}CKEDITOR.dtd.$empty["cke:source"]=1;CKEDITOR.dtd.$empty.source=1;a.lang.fakeobjects.video=b.fakeObject},afterInit:function(c){var a=c.dataProcessor,e=a&&a.htmlFilter,d=a&&a.dataFilter;var b=c.plugins.googleMapsHandler;d.addRules({elements:{$:function(h){if(h.name=="video"){h.name="cke:video";var g=c.createFakeParserElement(h,"cke_video","video",false),j=g.attributes.style||"";var i=h.attributes.width,f=h.attributes.height,k=h.attributes.poster;if(typeof i!="undefined"){j=g.attributes.style=j+"width:"+CKEDITOR.tools.cssLength(i)+";"}if(typeof f!="undefined"){j=g.attributes.style=j+"height:"+CKEDITOR.tools.cssLength(f)+";"}if(k){j=g.attributes.style=j+"background-image:url("+k+");"}return g}}}});e.addRules({elements:{$:function(h){if(h.name=="img"){var j=h.attributes.mapnumber;if(j){var f,i=c.plugins.googleMapsHandler,g=i.getMap(j);if(g&&g.generatedType>1){i.CreatedMapsNames.push(g.number);f=new CKEDITOR.htmlParser.cdata(g.BuildScript());h.parent.children.push(f)}delete h.attributes.mapnumber}}return h}}})}});